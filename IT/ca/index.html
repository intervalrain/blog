<!DOCTYPE html>
<html lang="zh-tw" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>[IT] Clean Architecture - 重點整理 | Rain Hu&#39;s Workspace</title>
<meta name="keywords" content="Clean Architecture, SOLID, DDD, Design Pattern">
<meta name="description" content="乾淨架構(Clean Architecture) 筆記
分層

乾淨架構中從外而內依序為

Framework Layer
Interface Adapter Layer
Application Layer
Domain Layer



Models

一般來說會有四個 Models

View Model(給前端)
App Model(App Layer 隔離 Domain Layer 所用，aka DTO)
Domain Model
Data Model(for DBMS)



Usecase

App Layer 中的 Usecase 做四件事：

查
改
存
推



單向依賴原則

依賴的方向必為單向且為
\(\boxed{\text{Interface Adapter}} \rightarrow \boxed{\text{Application Layer}} \rightarrow \boxed{\text{Domain Layer}}\)

Repository

Application Layer 為了遵守單向依賴，與 ORM 解耦會做一次依賴反轉，翠取 Repository 介面。

套用乾淨架構的效益衡量

Model Mapping 的成本 vs.

獨立出「領域模型」的價值
省下更換技術的成本(migration cost)



「領域層」的部分通常會結合 DDD">
<meta name="author" content="Rain Hu">
<link rel="canonical" href="https://intervalrain.github.io/">
<meta name="google-site-verification" content="XYZabc">
<meta name="msvalidate.01" content="XYZabc">
<link crossorigin="anonymous" href="/assets/css/stylesheet.662816b9df27c772d2b97c5f5f6bf4f2c5531051a330015f0ad4135736d0e56a.css" integrity="sha256-ZigWud8nx3LSuXxfX2v08sVTEFGjMAFfCtQTVzbQ5Wo=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/images/rain.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/images/rain.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/images/rain.png">
<link rel="apple-touch-icon" href="http://localhost:1313/images/rain.png">
<link rel="mask-icon" href="http://localhost:1313/images/rain.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh-tw" href="http://localhost:1313/it/ca/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js" integrity="sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>



<script async src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>

<script src="https://utteranc.es/client.js"
    repo="intervalrain.github.io"
    issue-term="pathname"
    label="Comment"
    theme="github-light"
    crossorigin="anonymous"
    async>
</script><meta property="og:url" content="http://localhost:1313/it/ca/">
  <meta property="og:site_name" content="Rain Hu&#39;s Workspace">
  <meta property="og:title" content="[IT] Clean Architecture - 重點整理">
  <meta property="og:description" content="乾淨架構(Clean Architecture) 筆記 分層 乾淨架構中從外而內依序為 Framework Layer Interface Adapter Layer Application Layer Domain Layer Models 一般來說會有四個 Models View Model(給前端) App Model(App Layer 隔離 Domain Layer 所用，aka DTO) Domain Model Data Model(for DBMS) Usecase App Layer 中的 Usecase 做四件事： 查 改 存 推 單向依賴原則 依賴的方向必為單向且為
\(\boxed{\text{Interface Adapter}} \rightarrow \boxed{\text{Application Layer}} \rightarrow \boxed{\text{Domain Layer}}\) Repository Application Layer 為了遵守單向依賴，與 ORM 解耦會做一次依賴反轉，翠取 Repository 介面。 套用乾淨架構的效益衡量 Model Mapping 的成本 vs. 獨立出「領域模型」的價值 省下更換技術的成本(migration cost) 「領域層」的部分通常會結合 DDD">
  <meta property="og:locale" content="zh-tw">
  <meta property="og:type" content="article">
    <meta property="article:section" content="it">
    <meta property="article:published_time" content="2023-09-23T20:03:55+08:00">
    <meta property="article:modified_time" content="2023-09-23T20:03:55+08:00">
    <meta property="article:tag" content="Clean Architectrue">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[IT] Clean Architecture - 重點整理">
<meta name="twitter:description" content="乾淨架構(Clean Architecture) 筆記
分層

乾淨架構中從外而內依序為

Framework Layer
Interface Adapter Layer
Application Layer
Domain Layer



Models

一般來說會有四個 Models

View Model(給前端)
App Model(App Layer 隔離 Domain Layer 所用，aka DTO)
Domain Model
Data Model(for DBMS)



Usecase

App Layer 中的 Usecase 做四件事：

查
改
存
推



單向依賴原則

依賴的方向必為單向且為
\(\boxed{\text{Interface Adapter}} \rightarrow \boxed{\text{Application Layer}} \rightarrow \boxed{\text{Domain Layer}}\)

Repository

Application Layer 為了遵守單向依賴，與 ORM 解耦會做一次依賴反轉，翠取 Repository 介面。

套用乾淨架構的效益衡量

Model Mapping 的成本 vs.

獨立出「領域模型」的價值
省下更換技術的成本(migration cost)



「領域層」的部分通常會結合 DDD">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "ITs",
      "item": "http://localhost:1313/it/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "[IT] Clean Architecture - 重點整理",
      "item": "http://localhost:1313/it/ca/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "[IT] Clean Architecture - 重點整理",
  "name": "[IT] Clean Architecture - 重點整理",
  "description": "乾淨架構(Clean Architecture) 筆記 分層 乾淨架構中從外而內依序為 Framework Layer Interface Adapter Layer Application Layer Domain Layer Models 一般來說會有四個 Models View Model(給前端) App Model(App Layer 隔離 Domain Layer 所用，aka DTO) Domain Model Data Model(for DBMS) Usecase App Layer 中的 Usecase 做四件事： 查 改 存 推 單向依賴原則 依賴的方向必為單向且為\n\\(\\boxed{\\text{Interface Adapter}} \\rightarrow \\boxed{\\text{Application Layer}} \\rightarrow \\boxed{\\text{Domain Layer}}\\) Repository Application Layer 為了遵守單向依賴，與 ORM 解耦會做一次依賴反轉，翠取 Repository 介面。 套用乾淨架構的效益衡量 Model Mapping 的成本 vs. 獨立出「領域模型」的價值 省下更換技術的成本(migration cost) 「領域層」的部分通常會結合 DDD",
  "keywords": [
    "Clean Architecture", "SOLID", "DDD", "Design Pattern"
  ],
  "articleBody": "乾淨架構(Clean Architecture) 筆記 分層 乾淨架構中從外而內依序為 Framework Layer Interface Adapter Layer Application Layer Domain Layer Models 一般來說會有四個 Models View Model(給前端) App Model(App Layer 隔離 Domain Layer 所用，aka DTO) Domain Model Data Model(for DBMS) Usecase App Layer 中的 Usecase 做四件事： 查 改 存 推 單向依賴原則 依賴的方向必為單向且為\n\\(\\boxed{\\text{Interface Adapter}} \\rightarrow \\boxed{\\text{Application Layer}} \\rightarrow \\boxed{\\text{Domain Layer}}\\) Repository Application Layer 為了遵守單向依賴，與 ORM 解耦會做一次依賴反轉，翠取 Repository 介面。 套用乾淨架構的效益衡量 Model Mapping 的成本 vs. 獨立出「領域模型」的價值 省下更換技術的成本(migration cost) 「領域層」的部分通常會結合 DDD ",
  "wordCount" : "70",
  "inLanguage": "zh-tw",
  "datePublished": "2023-09-23T20:03:55+08:00",
  "dateModified": "2023-09-23T20:03:55+08:00",
  "author":{
    "@type": "Person",
    "name": "Rain Hu"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/it/ca/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Rain Hu's Workspace",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/images/rain.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Rain Hu&#39;s Workspace (Alt + H)">
                <img src="http://localhost:1313/images/rain.png" alt="" aria-label="logo"
                    height="35">Rain Hu&#39;s Workspace</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/aboutme" title="About me">
                    <span>About me</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/csharp/csharp" title="C#">
                    <span>C#</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/csindex" title="CS">
                    <span>CS</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/leetcode" title="LeetCode">
                    <span>LeetCode</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">首頁</a>&nbsp;»&nbsp;<a href="http://localhost:1313/it/">ITs</a></div>
    <h1 class="post-title entry-hint-parent">
      [IT] Clean Architecture - 重點整理
    </h1>
    <div class="post-meta"><span title='2023-09-23 20:03:55 +0800 CST'>September 23, 2023</span>&nbsp;·&nbsp;1 分鐘&nbsp;·&nbsp;Rain Hu&nbsp;|&nbsp;<a href="https://github.com/intervalrain/intervalrain.github.io/tree/main/content//IT/CA.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">目錄</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e4%b9%be%e6%b7%a8%e6%9e%b6%e6%a7%8bclean-architecture-%e7%ad%86%e8%a8%98" aria-label="乾淨架構(Clean Architecture) 筆記">乾淨架構(Clean Architecture) 筆記</a><ul>
                            
                    <li>
                        <a href="#%e5%88%86%e5%b1%a4" aria-label="分層">分層</a></li>
                    <li>
                        <a href="#models" aria-label="Models">Models</a></li>
                    <li>
                        <a href="#usecase" aria-label="Usecase">Usecase</a></li>
                    <li>
                        <a href="#%e5%96%ae%e5%90%91%e4%be%9d%e8%b3%b4%e5%8e%9f%e5%89%87" aria-label="單向依賴原則">單向依賴原則</a></li>
                    <li>
                        <a href="#repository" aria-label="Repository">Repository</a></li>
                    <li>
                        <a href="#%e5%a5%97%e7%94%a8%e4%b9%be%e6%b7%a8%e6%9e%b6%e6%a7%8b%e7%9a%84%e6%95%88%e7%9b%8a%e8%a1%a1%e9%87%8f" aria-label="套用乾淨架構的效益衡量">套用乾淨架構的效益衡量</a></li>
                    <li>
                        <a href="#%e9%a0%98%e5%9f%9f%e5%b1%a4%e7%9a%84%e9%83%a8%e5%88%86%e9%80%9a%e5%b8%b8%e6%9c%83%e7%b5%90%e5%90%88-ddd" aria-label="「領域層」的部分通常會結合 DDD">「領域層」的部分通常會結合 DDD</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><h1 id="乾淨架構clean-architecture-筆記">乾淨架構(Clean Architecture) 筆記<a hidden class="anchor" aria-hidden="true" href="#乾淨架構clean-architecture-筆記">#</a></h1>
<h2 id="分層">分層<a hidden class="anchor" aria-hidden="true" href="#分層">#</a></h2>
<ul>
<li>乾淨架構中從外而內依序為
<ul>
<li>Framework Layer</li>
<li>Interface Adapter Layer</li>
<li>Application Layer</li>
<li>Domain Layer</li>
</ul>
</li>
</ul>
<h2 id="models">Models<a hidden class="anchor" aria-hidden="true" href="#models">#</a></h2>
<ul>
<li>一般來說會有四個 Models
<ul>
<li>View Model(給前端)</li>
<li>App Model(App Layer 隔離 Domain Layer 所用，aka DTO)</li>
<li>Domain Model</li>
<li>Data Model(for DBMS)</li>
</ul>
</li>
</ul>
<h2 id="usecase">Usecase<a hidden class="anchor" aria-hidden="true" href="#usecase">#</a></h2>
<ul>
<li>App Layer 中的 Usecase 做四件事：
<ul>
<li>查</li>
<li>改</li>
<li>存</li>
<li>推</li>
</ul>
</li>
</ul>
<h2 id="單向依賴原則">單向依賴原則<a hidden class="anchor" aria-hidden="true" href="#單向依賴原則">#</a></h2>
<ul>
<li>依賴的方向必為單向且為<br>
\(\boxed{\text{Interface Adapter}} \rightarrow \boxed{\text{Application Layer}} \rightarrow \boxed{\text{Domain Layer}}\)</li>
</ul>
<h2 id="repository">Repository<a hidden class="anchor" aria-hidden="true" href="#repository">#</a></h2>
<ul>
<li>Application Layer 為了遵守單向依賴，與 ORM 解耦會做一次依賴反轉，翠取 Repository 介面。</li>
</ul>
<h2 id="套用乾淨架構的效益衡量">套用乾淨架構的效益衡量<a hidden class="anchor" aria-hidden="true" href="#套用乾淨架構的效益衡量">#</a></h2>
<ul>
<li>Model Mapping 的成本 vs.
<ol>
<li>獨立出「領域模型」的價值</li>
<li>省下更換技術的成本(migration cost)</li>
</ol>
</li>
</ul>
<h2 id="領域層的部分通常會結合-ddd">「領域層」的部分通常會結合 DDD<a hidden class="anchor" aria-hidden="true" href="#領域層的部分通常會結合-ddd">#</a></h2>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/clean-architectrue/">Clean Architectrue</a></li>
    </ul>

  </footer><script src="https://utteranc.es/client.js"
    repo="Reid00/hugo-blog-talks"
    issue-term="pathname"
    label="Comment"
    theme="github-light"
    crossorigin="anonymous"
    async>
</script>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/">Rain Hu&#39;s Workspace</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '複製';

        function copyingDone() {
            copybutton.innerHTML = '已複製！';
            setTimeout(() => {
                copybutton.innerHTML = '複製';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
